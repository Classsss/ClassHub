@page "/classroom/{roomid:int}/lecturematerial"
@layout MainLayout
@inject HttpClient Http
@using ClassHub.Client.Models
@using ClassHub.Client.Shared.Board
@using ClassHub.Shared

@if(contents == null) {
    <div class="d-flex justify-content-center mt-5">
        <div class="spinner-border" style="width: 3rem; height: 3rem;" role="status" />
    </div>
} else {
    <Board Title="강의자료" Contents="@contents" />
}

@code {
    [Parameter]
    public int RoomId { get; set; }

    private List<BoardContent> contents;

    protected override async Task OnInitializedAsync() {
        await base.OnInitializedAsync();
        var materials = await Http.GetFromJsonAsync<List<LectureMaterial>>($"api/classroom/{RoomId}/lecturematerial/all");
        if(materials != null) {
            contents = new List<BoardContent>();
            foreach(var material in materials) {
                this.contents.Add(new LectureMaterialContent() {
                        room_id = material.room_id,
                        week = material.week,
                        content_id = material.material_id,
                        title = material.title,
                        author = material.author,
                        contents = material.contents,
                        publish_date = material.publish_date,
                        up_date = material.up_date,
                        view_count = material.view_count
                    });
            }
        }
    }
}
